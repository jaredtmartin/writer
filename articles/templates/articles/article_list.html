{% extends 'articles/base.html' %}
{% load actions %}
{% block navbar %}
  <li><a href="{% url article_add %}">Add Article</a></li>
{% endblock %}
{% block js %}
	<script type='text/javascript' src='{{STATIC_URL}}js/actions.js'></script>
  <script type='text/javascript' src='{{STATIC_URL}}js/ajax.js'></script>
{% endblock js %}
{% block content %}
  <!--  <div class="span2 filteroptions" style="border:none;background-color:#F9F9F9; height:100%;">
    <div class="block-fluid" style="border:none; height:100%;">
      <ul class="sList" style="border:none; height:355px;">
  	    <li>
  	        <form class="search_form" action="" method="GET">
  		        <input type="text" placeholder="Search" class="search-query" value="{{q}}" name="q" id="search-input">
                          <a href="#" onclick="$('#search_form').submit();"><i class="icon-remove"></i></a>
  	        </form>
  	    </li>
  	    <li>All Articles</li>
  	    <li>Unavailable</li>
  	    <li>Available</li>
  	    <li>Assigned</li>
  	    <li>Claimed</li>
  	    <li>Submitted</li>
  	    <li>Approved</li>
  	    <li>Rejected</li>
  	    <li>Published</li>
      </ul>                                                
    </div>
  </div> -->
  {% include "articles/action_bar.html"%}
  <div class="block-fluid table-sorting" style="border:none; ">
    <form class="actions-form" id="actions-form" method="post" action="">{% csrf_token %}
      <table cellpadding="0" cellspacing="0" width="100%" class="table" id="articles">
        <thead>
          <tr class="table-header-row">
            <th width="3%"><input type="checkbox" id="checkall" name="checkall" onClick="toggleMaster();" /></th>
            <th class="column-header project-column">Project</th>
            <th class="column-header keyword-column">Keywords</th>
            <th class="column-header writer-column">Writer</th>
            <th class="column-header reviewer-column">Reviewer</th>
            <th class="column-header type-column">Type</th>
            <th class="column-header category-column">Category</th>
            <th class="column-header length-column">Length</th>
            <th class="column-header priority-column">Priority</th>
            <th class="column-header tags-column">Tags</th>
            <th>
              <div id="show-columns-selector" class="btn-group">
                <a class="btn dropdown-toggle btn-small" data-toggle="dropdown">Show More <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li class="show-columns-option" id="reviewer-option"><a tabindex="-1" onclick="showColumn('reviewer');">Reviewer</a></li>
                  <li class="show-columns-option" id="type-option"><a tabindex="-1" onclick="showColumn('type');">Type</a></li>
                  <li class="show-columns-option" id="category-option"><a tabindex="-1" onclick="showColumn('category');">Category</a></li>
                  <li class="show-columns-option" id="length-option"><a tabindex="-1" onclick="showColumn('length');">Length</a></li>
                  <li class="show-columns-option" id="priority-option"><a tabindex="-1" onclick="showColumn('priority');">Priority</a></li>
                  <li class="show-columns-option" id="tags-option"><a tabindex="-1" onclick="showColumn('tags');">Tags</a></li>
                </ul>
              </div>

            </th>         
          </tr>
        </thead>
        <tbody>
          {% for article in object_list %}
            {% include "articles/article_list_row.html" %}
          {% endfor %}
        </tbody>
      </table>
    </form>
  </div>

  <script>
    function showColumn(section_id){
        $('.'+section_id+'-column').show();
        $('#'+section_id+'-option').hide();
        if($('.show-columns-option:visible').length == 0){$('#show-columns-selector').hide();}
    }
    $(document).ready(function(){
      window.row_selector='.article';
      showOrHideActionBar();
      checked_rows = $('.article :checked');
      if (checked_rows.length>0){selectRows(checked_rows.parents('tr'));}
      $('.tag-popover').popover(html=true, content=$('#tag-popover-html'));
      $('.category-column').hide();
      $('.length-column').hide();
      $('.priority-column').hide();
      $('.tags-column').hide();
      $('.type-column').hide();
      $('.reviewer-column').hide();
    });
  </script>
  <div id="tag-modal" class="modal hide fade">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h3>Change Tags</h3>
    </div>
    <div class="modal-body">
      <p>List the tags for this article separated by commas.</p>
      <input id="tag_input" name="tags" value="{{article.tags_as_str}}">
    </div>
    <div class="modal-footer">
      <a href="#" class="btn btn-primary" onclick="saveTags();return false;">Save</a>
      <a href="#" class="btn btn-primary" onclick="$('#tag-modal').modal('hide');">Cancel</a>
    </div>
  </div>
  <div id="reject-modal" class="modal hide fade">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h3>Reject Article</h3>
    </div>
    <div class="modal-body">
      <p>Please provide a brief explanation for rejecting the article.</p>
      <input id="reject_input">
    </div>
    <div class="modal-footer">
      <a href="#" class="btn btn-primary" onclick="rejectArticle('{% url reject_articles%}', window.article_id);return false;">Save</a>
      <a href="#" class="btn btn-primary" onclick="$('#reject-modal').modal('hide');">Cancel</a>
    </div>
  </div>
  <div id="delete-modal" class="modal hide fade">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h3>Delete Article</h3>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to delete this article?</p>
    </div>
    <div class="modal-footer">
      <a href="#" class="btn btn-primary" onclick="$('#delete-modal').modal('hide');doActionOnArticles('{% url delete_articles %}');return false;">Yes</a>
      <a href="#" class="btn btn-primary" onclick="$('#delete-modal').modal('hide');">No</a>
    </div>
  </div>
{% endblock %}
